@page "/AdminPage"
@attribute [Authorize(Roles = "Administration")]

@inject IMovieService MovieService
@using BioscoopSysteemWeb.Service
@using System.Security.Claims
@inject GetTicketInfoService GetTicketInfoService

<PageTitle>Index</PageTitle>

<a href="/AddMovie"><button class="btn btn-primary">Add movie</button></a>

@if (Films == null)
{
    <h3>Films worden opgehaald</h3>
}
else
{
    <div class="container d-flex align-items-center justify-content-center position-relative flex-wrap">

        @foreach (var movie in Films)
        {
            <div class="card d-flex position-relative flex-column">
                <div class='imgContainer'>
                    <img src="@movie.ImageUrl">
                </div>
                <h4>@movie.Name</h4>
                <a href="/UpdateMovie"><button class="btn btn-primary" @onclick="() => GetTicketInfoService.SetMovieId(movie.MovieId)">Update Movie</button></a>
                <div class="content">
                    <p><strong>Omschrijving: </strong>@movie.Description</p>
                    <p><strong>Prijs: </strong>@movie.Price</p>
                    <p><strong>Leeftijd: </strong>@movie.AllowedAge</p>
                    <p><strong>3D: </strong>@movie.Add3DMovie</p>
                    <p><strong>Datum/tijd: </strong>@movie.Date</p>
                </div>
            </div>
        }
    </div>
}



@code {
    public IEnumerable<MovieReadDTO>? Films { get; set; }
    private Modal modalRef;

    protected override async Task OnInitializedAsync()
    {
        Films = await MovieService.GetMovies();
    }
    
    private Task ShowModal()
    {
        return modalRef.Show();
    }

    private Task HideModal()
    {
        return modalRef.Hide();
    }
}